buildscript {
	ext {
		springBootVersion = "1.5.6.RELEASE"
		springCloudNetflixVersion = "1.3.2.RELEASE"
		springDependencyManagementVersion = "1.0.0.RELEASE"
		lombokVersion = "1.16.16"
		springfoxSwaggerVersion = "2.7.0"
		cucumberVersion = "1.2.5"
		
		useProxy = true
	}
	repositories {
		if(useProxy) {
			maven { url "http://nexus:8080/nexus/content/groups/public/" }
		} else {
			mavenCentral()
		}
	}
	dependencies {
		classpath "org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}"
		classpath("io.spring.gradle:dependency-management-plugin:{springDependencyManagementVersion}")
	}
}

subprojects {
	apply plugin: "java"
	apply plugin: "org.springframework.boot"
	apply plugin: "eclipse"
	apply plugin: "idea"
	apply plugin: "io.spring.dependency-management"

	version = version
	group = "org.lab.insurance"

	compileJava {
			sourceCompatibility = 1.8
			targetCompatibility = 1.8
			options.encoding = "UTF-8"
	}
	repositories {
		if(useProxy) {
			maven { url "http://nexus:8080/nexus/content/groups/public/" }
		} else {
			mavenCentral()
		}
	}

	dependencyManagement {
		imports {
			mavenBom "org.springframework.cloud:spring-cloud-netflix:${springCloudNetflixVersion}"
		}
	}

	dependencies {
		compile "org.projectlombok:lombok:${lombokVersion}"
		testCompile "org.springframework.boot:spring-boot-starter-test"		
	}
	
	// exclude version in jar file (tmp for docker-compose)
	jar.archiveName = "${jar.baseName}.${jar.extension}"
}

project(":insurance-model") {
	dependencies {
		compile "org.springframework.boot:spring-boot-starter-data-mongodb"
		compile "io.springfox:springfox-swagger2:${springfoxSwaggerVersion}"
		compile "org.hibernate:hibernate-validator"
	}
	bootRepackage {
		enabled = false
	}
}

project(":insurance-core") {
	dependencies {
		compile project(":insurance-model")
		compile "joda-time:joda-time:2.9.9"
		compile "commons-io:commons-io:2.5"
	}
	bootRepackage {
		enabled = false
	}
}

project(":insurance-services") {
	dependencies {
		compile project(":insurance-core")

		// remove
		compile group: 'org.apache.camel', name: 'camel-guice', version: '2.19.2'
		compileOnly "javax.servlet:javax.servlet-api:3.0.1"
		testCompile group: 'junit', name: 'junit', version: '4.12'
	}
	bootRepackage {
		enabled = false
	}
}

// deprecated project
project(":insurance-engine-model") {
	dependencies {
		compile project(":insurance-model")
	}
	bootRepackage {
		enabled = false
	}
}

// deprecated project
project(":insurance-engine") {
	dependencies {
		compile project(":insurance-services")
		compile project(":insurance-engine-model")
		
		// remove
		//compile "org.apache.camel:camel-guice:2.19.2"
		compile "org.apache.commons:commons-lang3:3.6"
	}
	bootRepackage {
		enabled = false
	}
}

// deprecated project
project(":insurance-bootstrap") {
	bootRepackage {
		enabled = false
	}
}

project(":insurance-eureka") {
	dependencies {
		compile "org.springframework.cloud:spring-cloud-starter-eureka-server"
		compile "org.springframework.cloud:spring-cloud-config-client"
	}
}

project(":insurance-cloud-config") {
	dependencies {
		compile "org.springframework.cloud:spring-cloud-config-server"
		compile "org.springframework.boot:spring-boot-starter-web"
	}
}


project(":insurance-ms-core") {
	dependencies {
		compile project(":insurance-model")
		compile project(":insurance-core")
		compile "org.springframework.boot:spring-boot-starter-web"
		compile "org.springframework.boot:spring-boot-starter-integration"
		compile "org.springframework.boot:spring-boot-starter-actuator"
		compile "org.springframework.boot:spring-boot-starter-amqp"

		compile "org.springframework.integration:spring-integration-mongodb"

		compile "org.springframework.cloud:spring-cloud-config-client"
		compile "org.springframework.cloud:spring-cloud-starter-eureka"

		compile "io.springfox:springfox-swagger-ui:${springfoxSwaggerVersion}"
	}
	bootRepackage {
		enabled = false
	}
}

project(":insurance-ms-contract-creation") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-contract-search") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-legal-entity") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-stop-loss") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-accounting") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-payment") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-asset") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-ms-market") {
	dependencies {
		compile project(":insurance-ms-core")
	}
}

project(":insurance-bdd") {
	dependencies {
		compile(project(":insurance-ms-contract-creation")) {
			exclude group: "io.springfox:springfox-swagger2"
			exclude group: "org.springframework.cloud"
		}
		
		testCompile "info.cukes:cucumber-junit:${cucumberVersion}"
		testCompile "info.cukes:cucumber-java:${cucumberVersion}"
		testCompile "info.cukes:cucumber-spring:${cucumberVersion}"
	}
	bootRepackage {
		enabled = false
	}
}


